// Nepali calendar data for years 2040-2090
export const nepaliCalendarData: { [key: number]: number[] } = {
  2040: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
  2041: [31, 31, 31, 32, 31, 31, 30, 29, 30, 29, 30, 30],
  2042: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
  2043: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
  2044: [31, 31, 31, 32, 31, 31, 29, 30, 30, 29, 30, 30],
  2045: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
  2046: [31, 32, 31, 32, 31, 30, 30, 29, 30, 29, 30, 30],
  2047: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
  2048: [31, 31, 31, 32, 31, 31, 30, 29, 30, 29, 30, 30],
  2049: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
  2050: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
  2051: [31, 31, 31, 32, 31, 31, 29, 30, 30, 29, 30, 30],
  2052: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
  2053: [31, 32, 31, 32, 31, 30, 30, 29, 30, 29, 30, 30],
  2054: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
  2055: [31, 31, 31, 32, 31, 31, 30, 29, 30, 29, 30, 30],
  2056: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
  2057: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
  2058: [31, 31, 31, 32, 31, 31, 29, 30, 30, 29, 30, 30],
  2059: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
  2060: [31, 32, 31, 32, 31, 30, 30, 29, 30, 29, 30, 30],
  2061: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
  2062: [31, 31, 31, 32, 31, 31, 30, 29, 30, 29, 30, 30],
  2063: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
  2064: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
  2065: [31, 31, 31, 32, 31, 31, 29, 30, 30, 29, 30, 30],
  2066: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
  2067: [31, 32, 31, 32, 31, 30, 30, 29, 30, 29, 30, 30],
  2068: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
  2069: [31, 31, 31, 32, 31, 31, 30, 29, 30, 29, 30, 30],
  2070: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
  2071: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
  2072: [31, 31, 31, 32, 31, 31, 29, 30, 30, 29, 30, 30],
  2073: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
  2074: [31, 32, 31, 32, 31, 30, 30, 29, 30, 29, 30, 30],
  2075: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
  2076: [31, 31, 31, 32, 31, 31, 30, 29, 30, 29, 30, 30],
  2077: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
  2078: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
  2079: [31, 31, 31, 32, 31, 31, 29, 30, 30, 29, 30, 30],
  2080: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
  2081: [31, 32, 31, 32, 31, 30, 30, 29, 30, 29, 30, 30],
  2082: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
  2083: [31, 31, 31, 32, 31, 31, 29, 30, 30, 29, 30, 30],
  2084: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
  2085: [31, 32, 31, 32, 31, 30, 30, 29, 30, 29, 30, 30],
  2086: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
  2087: [31, 31, 31, 32, 31, 31, 29, 30, 30, 29, 30, 30],
  2088: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30],
  2089: [31, 32, 31, 32, 31, 30, 30, 29, 30, 29, 30, 30],
  2090: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 29, 31],
};

const nepaliHolidays: {
  [key: number]: { [key: number]: { [key: number]: string } };
} = {
  2080: {
    1: {
      1: 'New Year',
      11: 'Janak Jayanti',
      14: 'Ram Navami',
    },
    2: {
      3: 'Akshaya Tritiya',
      7: 'Buddha Jayanti',
      15: 'Republic Day',
    },
    3: {
      15: 'Guru Purnima',
    },
  },
  2081: {
    1: {
      1: 'New Year',
      11: 'Janak Jayanti',
      14: 'Ram Navami',
    },
    2: {
      7: 'Buddha Jayanti',
      15: 'Republic Day',
    },
  },
  2082: {
    1: {
      1: 'नयाँ वर्ष',
      11: 'लोकतन्त्र दिवस',
      14: 'नेपाल सम्बत् नयाँ वर्ष',
    },
    2: {
      7: 'बुद्ध जयन्ती',
      15: 'गणतन्त्र दिवस',
      19: 'उभौली पर्व',
      29: 'रमजान ईद',
    },
    3: {
      15: 'गुरु पूर्णिमा',
      30: 'बकर ईद',
    },
    4: {
      15: 'नाग पञ्चमी',
      19: 'जनै पूर्णिमा',
      20: 'गाईजात्रा',
      23: 'श्रीकृष्ण जन्माष्टमी',
    },
    5: {
      5: 'हरितालिका तीज',
      7: 'ऋषि पञ्चमी',
      23: 'इन्द्रजात्रा',
      25: 'बाबा दे',
    },
    6: {
      2: 'विश्वकर्मा पूजा',
      24: 'घटस्थापना',
      30: 'फूलपाती',
    },
    7: {
      1: 'महाअष्टमी',
      2: 'महानवमी',
      3: 'विजया दशमी',
      4: 'पापाङ्कुशा एकादशी',
      7: 'कोजाग्रत पूर्णिमा',
    },
    8: {
      10: 'छठ पर्व',
      25: 'गुरु नानक जयन्ती',
    },
    9: {
      15: 'योमरी पुन्हि',
      30: 'क्रिसमस डे',
    },
    10: {
      1: 'तमु ल्होसार',
      15: 'माघे सङ्क्रान्ति',
      16: 'सोनम ल्होसार',
    },
    11: {
      7: 'सरस्वती पूजा',
      13: 'शिवरात्री',
      30: 'फागु पूर्णिमा',
    },
    12: {
      8: 'घोडे जात्रा',
      14: 'घाँटु नाच',
      24: 'राम नवमी',
    },
  },
};

export const getNepaliMonthDays = (year: number, month: number): number => {
  if (nepaliCalendarData[year] && nepaliCalendarData[year][month - 1]) {
    return nepaliCalendarData[year][month - 1];
  }
  return 30; // Default fallback
};

export const getNepaliMonthName = (month: number, locale: string): string => {
  const months = {
    en: [
      'Baisakh',
      'Jestha',
      'Ashar',
      'Shrawan',
      'Bhadra',
      'Ashwin',
      'Kartik',
      'Mangsir',
      'Poush',
      'Magh',
      'Falgun',
      'Chaitra',
    ],
    ne: [
      'बैशाख',
      'जेठ',
      'असार',
      'श्रावण',
      'भाद्र',
      'आश्विन',
      'कार्तिक',
      'मंसिर',
      'पुष',
      'माघ',
      'फाल्गुन',
      'चैत्र',
    ],
  };
  return months[locale as keyof typeof months][month - 1];
};

export const getWeekDayName = (day: number, locale: string): string => {
  const weekDays = {
    en: [
      'Sunday',
      'Monday',
      'Tuesday',
      'Wednesday',
      'Thursday',
      'Friday',
      'Saturday',
    ],
    ne: [
      'आइतबार',
      'सोमबार',
      'मंगलबार',
      'बुधबार',
      'बिहिबार',
      'शुक्रबार',
      'शनिबार',
    ],
  };
  return weekDays[locale as keyof typeof weekDays][day];
};

export const generateCalendarDays = (year: number, month: number): number[] => {
  const daysInMonth = getNepaliMonthDays(year, month);
  return Array.from({ length: daysInMonth }, (_, i) => i + 1);
};

export const getCurrentNepaliDate = (): {
  year: number;
  month: number;
  day: number;
} => {
  const today = new Date();
  const diffTime = Math.abs(today.getTime() - new Date(1983, 3, 14).getTime());
  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

  let remainingDays = diffDays;
  let nepaliYear = 2040;
  let nepaliMonth = 1;
  let nepaliDay = 1;

  while (remainingDays > 0) {
    const daysInMonth = getNepaliMonthDays(nepaliYear, nepaliMonth);
    if (remainingDays >= daysInMonth) {
      remainingDays -= daysInMonth;
      nepaliMonth++;
      if (nepaliMonth > 12) {
        nepaliMonth = 1;
        nepaliYear++;
      }
    } else {
      nepaliDay += remainingDays;
      remainingDays = 0;
    }
  }

  return { year: nepaliYear, month: nepaliMonth, day: nepaliDay };
};

export const getAllHolidays = (
  year: number
): { [key: string]: { [key: string]: string } } => {
  const yearHolidays = nepaliHolidays[year] || {};
  const result: { [key: string]: { [key: string]: string } } = {};

  for (const month in yearHolidays) {
    result[month] = {};
    for (const day in yearHolidays[month]) {
      result[month][day] = yearHolidays[month][day];
    }
  }

  return result;
};

export const getNepaliHoliday = (
  year: number,
  month: number,
  day: number
): string | null => {
  return nepaliHolidays[year]?.[month]?.[day] || null;
};

export const getStartDayOfMonth = (year: number, month: number): number => {
  const baseWeekDay = 3; // Wednesday (2040-01-01 BS was a Wednesday)
  let totalDays = 0;

  // Calculate total days from base year to the given year
  for (let y = 2040; y < year; y++) {
    for (let m = 1; m <= 12; m++) {
      totalDays += getNepaliMonthDays(y, m);
    }
  }

  // Add days for the months in the current year up to the given month
  for (let m = 1; m < month; m++) {
    totalDays += getNepaliMonthDays(year, m);
  }

  // Calculate the weekday
  return (baseWeekDay + totalDays) % 7;
};
